name: Params
format: "1.0"
domain: https://httpbin.org
tags:
  - working

scenarios:

  - start: 1
    adder: 2
    check: 3
    final: 5


steps:

  - description: Pass the show_env flag, get it back and add a value to it
    request:
        path: /get
        params:
            show_env: ${scenario.start}

    extract:
        check: ${response['args.show_env']} + ${scenario.adder}

    validate:

      - expect: https://httpbin.org/get?show_env=${scenario.start}
        actual: ${response.url}

      - expect: ${scenario.start}
        actual: ${response['args.show_env']}

      - expect: ${scenario.check}
        actual: ${check}                # extract values are top-level in NS

      - expect: ${scenario.check}
        actual: ${extract.check}        # extract values under 'extract.' too!

  - description: Pass the show_env flag from previous case.

    request:
        path: /get
        params:
            show_env: ${extract.check}

    extract:
        final: ${response["args.show_env"]} + ${scenario.adder}

    validate:
      - expect: https://httpbin.org/get?show_env=${extract.check}
        actual: ${response.url}

      - expect: ${extract.check}
        actual: ${response['args.show_env']}

      - expect: ${scenario.final}
        actual: ${final}             # extract values are top-level in NS

      - expect: ${scenario.final}
        actual: ${extract.final}     # extract values under 'extract.' too!
